<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>index.html</title>
    <style>
        body {
            font-family: monospace;
            background-color: white;
            color: black;
            margin: 0;
            padding: 0;
            position: relative;
            min-height: 100vh;
        }
        nav {
            background-color: #f4f4f4;
            border-bottom: 1px solid #ccc;
            padding: 10px;
            position: relative;
            z-index: 2;
        }
        nav a {
            text-decoration: none;
            color: #0000FF;
            margin-right: 5px;
        }
        nav span {
            color: #999;
            margin-right: 5px;
        }
        main {
            padding: 20px;
            position: relative;
            z-index: 2;
            max-width: 100%;
            box-sizing: border-box;
        }
        header {
            font-size: 24px;
            margin-bottom: 20px;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            margin: 8px 0;
        }
        a:hover {
            text-decoration: underline;
        }
        .file-link {
            color: #0000FF;
        }
        #ascii-bg {
            position: fixed;
            bottom: 0;
            right: 0;
            font-family: monospace;
            font-size: 12px;
            line-height: 10px;
            color: #0000FF;
            opacity: 0.6;
            pointer-events: none;
            white-space: pre;
            z-index: 1;
        }
        #feedback-section textarea {
            width: 100%;       /* fill available space */
            max-width: 500px;  /* keeps it reasonable on desktop */
            box-sizing: border-box; /* include padding in width */
        }

        @media (max-width: 600px) {
            header {
                font-size: 20px;
                margin-bottom: 15px;
            }

            nav {
                padding: 8px;
            }

            nav a {
                margin-right: 4px;
                font-size: 14px;
            }

            ul li {
                margin: 6px 0;
            }

            #ascii-bg {
                font-size: 10px;
                line-height: 8px;
            }

            #feedback-section textarea {
                font-size: 14px;
            }

            button {
                font-size: 14px;
            }
        }
        @media (max-width: 768px) {
            #about-text {
                white-space: pre-wrap;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
            #ascii-bg {
                font-size: 8px;
                line-height: 6px;
                max-width: 100%;
                max-height: 50%;
                opacity: 0.3;
                bottom: 0;
                right: 0;
            }
        }

    </style>
</head>
<body>
    <div id="ascii-bg">Loading animation...</div>
    <nav id="breadcrumb">
        <a href="#" onclick="loadPage('home')">home</a>
    </nav>
    <main id="content">
    </main>

    <script type="module">
        //firebase import
        import { initFeedbackPage } from './firebase.js';
        //animation frame import
        import { animations } from './animations.js';

        //site pages
        const pages = {
            home: {
                breadcrumb: ['home'],
                content: `<header>ev4</header>
                    <ul>
                        <li><a href="#" onclick="loadPage('about')">about</a></li>
                        <li><a href="#" onclick="loadPage('projects')">projects</a></li>
                        <li><a href="#" onclick="loadPage('feedback')">feedback</a></li>
                    </ul>`
            },
            about: {
                breadcrumb: ['home', 'about'],
                content: `<ul>
                        <li><a class="file-link" href="#" onclick="loadPage('about_txt')">about.txt</a></li>
                        <li><a class="file-link" href="resume.pdf" target="_blank" rel="noopener noreferrer">resume.pdf</a></li>
                        <li><a class="file-link" href="#" onclick="loadPage('links')">links</a></li>
                    </ul>`
            },
            about_txt: {
                breadcrumb: ['home', 'about', 'about.txt'],
                content: `<pre id="about-text">Hello, my name is Erce "EV" Phillips.\nI am a <span id="age"></span> year old technical consultant and software developer from Northern California.\nMy specialized areas of interest include game and web development, with an emphasis on lightweight and functional design.\nI am currently most proficient in Python and standard HTML/CSS, but also strive to improve with C++/C# for making games in the future.\nWhen I'm not working for my company or on personal projects, I am usually:<ul style="list-style: disc; padding-left: 40px; margin-top: 0; margin-bottom: 0;"><li>playing fighting games</li><li>surfing</li><li>in the gym</li><li>learning new languages</li><li>driving around</li></ul>Please feel free to browse this site for more information or stay connected via my social media in the 'links' section.\nI look forward to continuing to share with you.</pre>`
            },
            links: {
                breadcrumb: ['home', 'about', 'links'],
                content: `<ul>
                        <li><a href="https://instagram.com/ev4.eva" target="_blank" rel="noopener noreferrer">instagram.com</a></li>
                        <li><a href="https://github.com/ev-98" target="_blank" rel="noopener noreferrer">github.com</a></li>
                        <li><a href="https://linkedin.com/in/erce-phillips" target="_blank" rel="noopener noreferrer">linkedin.com</a></li>
                    </ul>`
            },
            projects: {
                breadcrumb: ['home', 'projects'],
                content: `<ul>
                    <li>
                        <a href="https://github.com/ev-98/lets-go-justin" target="_blank">lets-go-justin</a>
                        <span style="font-style: italic; color: #777; font-size: 0.9em;"> (discord bot, python)</span>
                    </li>
                    <li>
                        <a href="https://github.com/ev-98/ev4-info" target="_blank">site source code</a>
                    </li>
                </ul>`
            },

            feedback: {
                breadcrumb: ['home', 'feedback'],
                content: `<div id="feedback-section">
                        <h3>Leave a comment</h3>
                        <textarea id="comment-input" rows="4" cols="50" style="width:100%; max-width:500px;"></textarea><br>
                        <button id="submit-comment" style="margin-top: 8px;">Submit</button>
                        <h3>Comments</h3>
                        <div id="comment-list"></div>
                        </div>`
                        }
        };

        function loadPage(page) {
            const data = pages[page];
            const breadcrumbNav = data.breadcrumb
                .map((item, index) => {
                    if (index === data.breadcrumb.length - 1) {
                        return `<span>${item}</span>`;
                    } else {
                        return `<a href="#" onclick=\"loadPage('${item}')\">${item}</a>`;
                    }
                })
                .join(' / ');

            document.getElementById('breadcrumb').innerHTML = breadcrumbNav;
            let contentHTML = '';
            contentHTML += data.content;
            document.getElementById('content').innerHTML = contentHTML;
            if (document.getElementById("age")) {
                startLiveAge();
            }
            if (page === "feedback") {
                initFeedbackPage('comment-input', 'submit-comment', 'comment-list');
            }
        }

        //load home by default
        loadPage('home');


        var asciicolor = '#0000FF';
        var currentAnimation = animations[Math.floor(Math.random() * animations.length)];

        //animation function
        async function playAscii() {
            var frames = currentAnimation.length;
            for (var i = 0; i < frames; i++) {
                document.getElementById('ascii-bg').innerHTML = `<font color='${asciicolor}'><pre>${currentAnimation[i]}</pre></font>`;
                await new Promise(r => setTimeout(r, 29));
            }
            playAscii();
        }

        playAscii();

        //live age function
        function startLiveAge() {
            const birthDate = new Date("1998-04-20T08:00:00");

            function update() {
                const now = new Date();
                const diffMs = now - birthDate;

                const years = diffMs / (1000 * 60 * 60 * 24 * 365.25);
                document.getElementById("age").textContent = years.toFixed(9); 
            }

            update();
            setInterval(update, 100);
            }

    </script>
</body>
</html>
